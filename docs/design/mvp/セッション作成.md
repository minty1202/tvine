# セッション作成

## 概要

「+ New」ボタンからモーダルを開き、worktree をセットアップする。
スロットが選択されていれば、テンプレートファイルの配置と作成時コマンドも実行される。

## 入力項目

| 項目 | 必須 | 説明 |
| --- | --- | --- |
| ベースブランチ | 必須 | セレクト。main / develop 等から選択 |
| ブランチ名 | 必須 | オートコンプリート付きテキスト入力。ローカルブランチから選択するか、新しいブランチ名を入力 |
| スロット | 任意 | 既存スロットから選択。未選択でもセッション作成可。排他スロットが使用中の場合は選択不可として表示 |

スロットを選ぶ時、スロット作成モーダルへの導線を表示する。

## バリデーション

- ブランチ名が空でないこと
- ブランチ名が git の命名規則に従っていること
- 既に worktree として使用中のブランチでないこと

## 作成時の処理

1. セッション ID（UUID）を生成し、セッションディレクトリと session.json を作成
2. `git worktree add ../<dir-name>` で worktree を新規作成（ブランチ名の `/` は `-` に置き換え。例: `feature/1` → `../feature-1`）
3. ターミナルの PTY を作成
4. スロットが選択されている場合：
   a. テンプレートファイルを worktree に配置
   b. 作成時コマンドを実行
5. セッションを選択状態にする（Claude Code はセッション選択時に起動される）

## エラー時

| ケース | 対応 |
| --- | --- |
| git コマンド失敗 | git のエラーメッセージをそのまま表示、作成を中止 |
| 作成時コマンド失敗 | エラーを表示するが、セッション自体は作成済みとして残す |
